var ct=Object.create;var Oe=Object.defineProperty;var lt=Object.getOwnPropertyDescriptor;var ut=Object.getOwnPropertyNames;var dt=Object.getPrototypeOf,pt=Object.prototype.hasOwnProperty;var Me=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var ge=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var ht=(e,r,t,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of ut(r))!pt.call(e,a)&&a!==t&&Oe(e,a,{get:()=>r[a],enumerable:!(o=lt(r,a))||o.enumerable});return e};var Te=(e,r,t)=>(t=e!=null?ct(dt(e)):{},ht(r||!e||!e.__esModule?Oe(t,"default",{value:e,enumerable:!0}):t,e));var Fe=ge((le,Ke)=>{"use strict";var Tt=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},se=Tt();Ke.exports=le=se.fetch;se.fetch&&(le.default=se.fetch.bind(se));le.Headers=se.Headers;le.Request=se.Request;le.Response=se.Response});var Ue=ge((tr,Le)=>{Ct()?Ce=window.fetch:Ce=Fe();var Ce;function Ct(){try{return window.fetch,!0}catch{return!1}}var Et={delay(e){return new Promise(r=>setTimeout(r,e))},tools:{exponentialBackoff(e){return Math.pow(2,e-1)*1e3}},defaults:{retryDelay(e,r){return r.details.response.status===429?Math.pow(2,e-1)*1e3:1e3},retryOn(e,r){return!!(r.details&&r.details.response&&(r.details.response.status>=500||r.details.response.status===429))}},async wrapper(e,r={},t={}){try{let a=await Ce(e,r),l=await a.text(),i=null;if(o(l)&&(i=JSON.parse(l)),a&&a.ok)return{url:e,options:r,response:a,helperData:t,json:i,text:l};let m=new Error(`Successful http request but response.ok === false. Code: ${a.status}, Text: ${l}`);throw m.details={url:e,options:r,response:a,helperData:t,json:i,text:l},m}catch(a){throw a.details?a.datails:a.details={url:e,options:r,helperData:t},a}function o(a){try{return JSON.parse(a),!0}catch{return!1}}},async one(e={url,options,helperData,retries,retryDelay,retryOn}){if(typeof e!="object"||!e.url)throw new Error("Invalid argument when calling _fetch.one. You must call _fetch.one with an object (settings), containing at-minimum: settings = {url: string}");e.options||(e.options={method:"GET"}),e.options&&!e.options.method&&(e.options.method="GET"),!e.retries&&e.retries!==0&&(e.retries=5),typeof e.retryDelay!="function"&&typeof e.retryDelay!="number"&&(e.retryDelay=this.defaults.retryDelay),typeof e.retryOn!="function"&&(e.retryOn=this.defaults.retryOn);let r;for(let t=0;t<=e.retries;t++)try{if(t>0){let o;typeof e.retryDelay=="function"?o=e.retryDelay(t,r):o=e.retryDelay,await this.delay(o)}return await this.wrapper(e.url,e.options,e.helperData)}catch(o){if(t===e.retries||!await e.retryOn(t,o))throw o;r=o,console.log(`failed fetch ${e.options.method} to ${e.url}. Code: ${o.details&&o.details.response?o.details.response.status:""}. Attempt ${t}. Retrying...`)}},async many(e={requests,delayMs,progressCbs}){e.delayMs||(e.delayMs=125);let r=[];e.requests.forEach((a,l)=>{let i=(async()=>{await this.delay(l*e.delayMs);let m=await this.one({url:a.url,options:a.options,retries:a.retries,retryDelay:a.retryDelay,retryOn:a.retryOn,helperData:{request:a,delayMs:l*e.delayMs,i:l}});return o++,e.progressCbs&&e.progressCbs.length&&e.progressCbs.forEach(w=>{w(o,t,m)}),m})();r.push(i)});let t=r.length,o=0;return Promise.allSettled(r)}};typeof Me<"u"&&(Le.exports=Et)});var Ee=ge((nr,Ne)=>{var ae=Ue();function St(e){r(),e.auth==="view-based"?this.headers={"X-Knack-Application-ID":e.applicationId,"X-Knack-REST-API-Key":"knack",Authorization:typeof e.userToken=="string"?e.userToken:"","Content-Type":"application/json"}:e.auth==="object-based"&&(this.headers={"X-Knack-Application-ID":e.applicationId,"X-Knack-REST-API-Key":e.apiKey,"Content-Type":"application/json"}),this.urlBase="https://api.knack.com/v1",this.remoteLogin=async function(t={email,password}){return await ae.one({url:`${this.urlBase}/applications/${this.headers["X-Knack-Application-ID"]}/session`,options:{method:"POST",body:JSON.stringify({email:t.email,password:t.password}),headers:{"Content-Type":"application/json"}}})},this.login=async function(t={email,password}){if(t.email&&t.password){let a=(await this.remoteLogin(t)).json.session.user.token;return this.headers.Authorization=a,a}else throw new Error("You did not specify one/both of email and password in settings object. Could not log in")},this.validateSession=async function(t={userToken,userRoleCheck}){if(typeof t.userToken!="string")throw new Error("You must provide a settings object with at least a userToken (string) to validateSession()");try{let a=(await ae.one({url:`${this.urlBase}/session/token`,options:{method:"GET",headers:{Authorization:t.userToken,"x-knack-application-id":this.headers["X-Knack-Application-ID"]}}})).json?.session;if(!a)throw new Error("No session found");if(a.user.status!=="current")throw new Error("Valid user but session not current.");if(a.user.account_status!=="active")throw new Error("Valid user but status not active.");if(a.user.approval_status!=="approved")throw new Error("Valid user but approval status is not approved.");if(t.userRoleCheck&&!a.user.profile_keys.includes(t.userRoleCheck))throw new Error("Valid user but does not include the specified user role.");return!0}catch{return!1}},this.url=function(t={scene,view,object,recordId}){let o=this.urlBase;return e.auth==="view-based"?o+=`/pages/${t.scene}/views/${t.view}/records/`:e.auth==="object-based"&&(o+=`/objects/${t.object}/records/`),t.recordId&&(o+=t.recordId),o},this.getRetries=function(t){return typeof t=="number"?t:5},this.setup=function(t,o){let a="";e.auth==="view-based"?a=this.url({scene:o.scene,view:o.view,recordId:o.recordId}):e.auth==="object-based"&&(a=this.url({object:o.object,recordId:o.recordId}));let l={method:t,headers:this.headers};o.body&&(l.body=JSON.stringify(o.body));let i=this.getRetries(o.retries);return{url:a,options:l,retries:i,helperData:o.helperData}},this.single=async function(t,o){let a=this.setup(t,o);return await ae.one(a)},this.many=async function(t,o){if(t==="GET")return console.log("knackAPI.many is only for POST, PUT and DELETE");let a=[];o.records.forEach(m=>{let w={view:o.view,scene:o.scene,object:o.object,retries:o.retries};t!=="DELETE"&&(w.body=m),t!=="POST"&&(w.recordId=m.id),a.push(this.setup(t,w))}),o.resultsReport&&this.tools.manyResultsReport.remove(o.resultsReport);let l=this.progressCbsSetup(o),i=await ae.many({requests:a,delayMs:125,progressCbs:l});return i.settings=o,i.summary=this.tools.manyResultsReport.calc(i),o.resultsReport&&this.tools.manyResultsReport.create(o.resultsReport,i),i},this.progressCbsSetup=function(t){let o=[];return t.progressBar&&(this.tools.progressBar.create(t.progressBar),o.push((a,l,i)=>{this.tools.progressBar.update(t.progressBar.id,a,l)})),t.progressCbs&&t.progressCbs.length&&t.progressCbs.forEach(a=>o.push(a)),o},this.get=async function(t={view,scene,object,recordId,helperData}){return await this.single("GET",t)},this.post=async function(t={view,scene,object,body,helperData,retries}){return await this.single("POST",t)},this.put=async function(t={recordId,view,scene,object,body,helperData,retries}){return await this.single("PUT",t)},this.delete=async function(t={recordId,view,scene,object,helperData,retries}){return await this.single("DELETE",t)},this.getMany=async function(t={view,scene,object,filters,rowsPerpage,startAtPage,maxRecordsToGet,helperData},o=1,a={records:[],pages:[]}){let l=this.setup("GET",t);o===1&&t.startAtPage>1&&(o=t.startAtPage);let i=t.maxRecordsToGet>0?t.maxRecordsToGet:1/0,m=t.rowsPerPage?t.rowsPerPage:1e3;l.url+=`?page=${o}&rows_per_page=${m}`,t.format&&(l.url+=`&format=${t.format}`),t.filters&&(l.url+=`&filters=${JSON.stringify(t.filters)}`);let w=await ae.one(l);return a.pages.push(w),w.json.records.map(H=>a.records.push(H)),a.helperData=t.helperData,a.records.length>i&&(a.records=a.records.splice(0,i)),a.records.length<i&&w.json.current_page<w.json.total_pages?await this.getMany(t,w.json.current_page+1,a):a},this.putMany=async function(t={records,view,scene,object,helperData,retries,progressBar,progressCbs,resultsReport}){return await this.many("PUT",t)},this.postMany=async function(t={records,view,scene,object,helperData,retries,progressBar,progressCbs,resultsReport}){return await this.many("POST",t)},this.deleteMany=async function(t={records,view,scene,object,helperData,retries,progressBar,progressCbs,resultsReport}){return await this.many("DELETE",t)},this.getFromReportView=async function(t={view,scene,sceneRecordId,helperData,retries}){if(e.auth!=="view-based")throw new Error("getFromReportView() only works when using view-based auth");if(!t.view||!t.scene)throw new Error("getFromReportView() requires a view and scene. You did not specify one or both.");if(t.recordId)throw new Error(`getFromReportView() does not support recordId. Specify settings.sceneRecordId if you are trying to load a report on a child page that has the data source of "this page's record" or similar.`);let o=`${this.urlBase}/scenes/${t.scene}/views/${t.view}/report`;if(t.sceneRecordId){let l=await this.getSceneSlug(t.scene);o+=`?${l}_id=${t.sceneRecordId}`}let a={url:o,options:{method:"GET",headers:this.headers},retries:this.getRetries(t.retries),helperData:t.helperData};return await ae.one(a)},this.tools={progressBar:{html(t){return $(`
                    <div id="${t}" style="margin-bottom: 10px;">
                        <span class="before-progress-bar" style="margin-right: 5px;"><em><strong>Processing records</em></strong></span>
                        <progress id="progressBar" value="0" max="100"></progress>
                        <span class="after-progress-bar" style="margin-left: 5px;" id="progressText">Initialising...</span>
                    </div>
                `)},update(t,o,a){$(`#${t} #progressBar`).val(Math.round(o/a*100)),$(`#${t} #progressText`).text(`${o}/${a}`)},create(t){$(`#${t.id}`).remove(),t.insertAfter?this.html(t.id).insertAfter(t.insertAfter):t.insertBefore?this.html(t.id).insertBefore(t.insertBefore):t.appendTo?this.html(t.id).appendTo(t.appendTo):t.prependTo?this.html(t.id).prependTo(t.prependTo):console.log("Invalid progress bar location")}},manyResultsReport:{calc(t){let o=t.reduce((i,m)=>(m.status==="fulfilled"&&i++,i),0),a=t.reduce((i,m)=>(m.status==="rejected"&&i++,i),0),l=t.filter(i=>i.status!=="fulfilled");return{fulfilled:o,rejected:a,errors:l}},html(t,o){let a=this.calc(o);return $(`
                    <div id=${t}>
                        <p><strong>Finished processing</strong></p>
                        <p>Summary:</p>
                        <p>
                            <ul>
                                <li>Failed: ${a.rejected}</li>
                                <li>Succeeded: ${a.fulfilled}</li>
                            </ul>
                        </p>
                    </div>
                `)},create(t,o){t.insertAfter?this.html(t.id,o).insertAfter(t.insertAfter):t.insertBefore?this.html(t.id,o).insertBefore(t.insertBefore):t.appendTo?this.html(t.id,o).appendTo(t.appendTo):t.prependTo?this.html(t.id,o).prependTo(t.prependTo):console.log("Invalid summary location")},remove(t){$(`#${t.id}`).remove()}}},this.getSceneSlug=async function(t){let o=`${this.urlBase}/applications/${this.headers["X-Knack-Application-ID"]}`,i=(await ae.one({url:o,options:{method:"GET"}})).json.application.scenes.find(w=>w.key===t);if(!i)throw new Error(`Scene with key ${t} not found, when trying to find corresponding slug (url). Could not continue.`);let m=i.slug;if(!m)throw new Error(`Scene with key ${t} found, but no slug (url) found. Could not continue.`);return m};function r(){if(!e)throw new Error("KnackAPI config settings object not found");if(!e.auth)throw new Error("KnackAPI.auth configuration not found");if(e.auth!=="object-based"&&e.auth!=="view-based")throw new Error(`KnackAPI.auth invalid - should be "view-based" or "object-based" but got "${e.auth}"`);if(!e.applicationId)throw new Error("KnackAPI.applicationId not found");if(e.auth==="object-based"&&!e.apiKey)throw new Error("Object-based auth selected but did not find an API key");try{e.auth==="object-based"&&Knack&&console.log(`
                    Warning! Object-based auth selected but it looks like you are running code in the Knack Javascript area. 
                    We strongly recommend you use view-based auth instead;
                `)}catch{}}}Ne.exports=St});var et=ge((Se,Ae)=>{(function(e,r){typeof define=="function"&&define.amd?define([],r):typeof Ae=="object"&&typeof Se<"u"?Ae.exports=r():e.Papa=r()})(Se,function e(){"use strict";var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},t=!r.document&&!!r.postMessage,o=r.IS_PAPA_WORKER||!1,a={},l=0,i={parse:function(s,n){var c=(n=n||{}).dynamicTyping||!1;if(b(c)&&(n.dynamicTypingFunction=c,c={}),n.dynamicTyping=c,n.transform=!!b(n.transform)&&n.transform,n.worker&&i.WORKERS_SUPPORTED){var u=function(){if(!i.WORKERS_SUPPORTED)return!1;var g=(K=r.URL||r.webkitURL||null,I=e.toString(),i.BLOB_URL||(i.BLOB_URL=K.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",I,")();"],{type:"text/javascript"})))),k=new r.Worker(g),K,I;return k.onmessage=it,k.id=l++,a[k.id]=k}();return u.userStep=n.step,u.userChunk=n.chunk,u.userComplete=n.complete,u.userError=n.error,n.step=b(n.step),n.chunk=b(n.chunk),n.complete=b(n.complete),n.error=b(n.error),delete n.worker,void u.postMessage({input:s,config:n,workerId:u.id})}var p=null;return i.NODE_STREAM_INPUT,typeof s=="string"?(s=function(g){return g.charCodeAt(0)===65279?g.slice(1):g}(s),p=n.download?new H(n):new pe(n)):s.readable===!0&&b(s.read)&&b(s.on)?p=new fe(n):(r.File&&s instanceof File||s instanceof Object)&&(p=new ie(n)),p.stream(s)},unparse:function(s,n){var c=!1,u=!0,p=",",g=`\r
`,k='"',K=k+k,I=!1,h=null,D=!1;(function(){if(typeof n=="object"){if(typeof n.delimiter!="string"||i.BAD_DELIMITERS.filter(function(d){return n.delimiter.indexOf(d)!==-1}).length||(p=n.delimiter),(typeof n.quotes=="boolean"||typeof n.quotes=="function"||Array.isArray(n.quotes))&&(c=n.quotes),typeof n.skipEmptyLines!="boolean"&&typeof n.skipEmptyLines!="string"||(I=n.skipEmptyLines),typeof n.newline=="string"&&(g=n.newline),typeof n.quoteChar=="string"&&(k=n.quoteChar),typeof n.header=="boolean"&&(u=n.header),Array.isArray(n.columns)){if(n.columns.length===0)throw new Error("Option columns is empty");h=n.columns}n.escapeChar!==void 0&&(K=n.escapeChar+k),(typeof n.escapeFormulae=="boolean"||n.escapeFormulae instanceof RegExp)&&(D=n.escapeFormulae instanceof RegExp?n.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var y=new RegExp(he(k),"g");if(typeof s=="string"&&(s=JSON.parse(s)),Array.isArray(s)){if(!s.length||Array.isArray(s[0]))return V(null,s,I);if(typeof s[0]=="object")return V(h||Object.keys(s[0]),s,I)}else if(typeof s=="object")return typeof s.data=="string"&&(s.data=JSON.parse(s.data)),Array.isArray(s.data)&&(s.fields||(s.fields=s.meta&&s.meta.fields||h),s.fields||(s.fields=Array.isArray(s.data[0])?s.fields:typeof s.data[0]=="object"?Object.keys(s.data[0]):[]),Array.isArray(s.data[0])||typeof s.data[0]=="object"||(s.data=[s.data])),V(s.fields||[],s.data||[],I);throw new Error("Unable to serialize unrecognized input");function V(d,E,U){var R="";typeof d=="string"&&(d=JSON.parse(d)),typeof E=="string"&&(E=JSON.parse(E));var F=Array.isArray(d)&&0<d.length,M=!Array.isArray(E[0]);if(F&&u){for(var j=0;j<d.length;j++)0<j&&(R+=p),R+=L(d[j],j);0<E.length&&(R+=g)}for(var f=0;f<E.length;f++){var _=F?d.length:E[f].length,S=!1,O=F?Object.keys(E[f]).length===0:E[f].length===0;if(U&&!F&&(S=U==="greedy"?E[f].join("").trim()==="":E[f].length===1&&E[f][0].length===0),U==="greedy"&&F){for(var T=[],N=0;N<_;N++){var x=M?d[N]:N;T.push(E[f][x])}S=T.join("").trim()===""}if(!S){for(var C=0;C<_;C++){0<C&&!O&&(R+=p);var Y=F&&M?d[C]:C;R+=L(E[f][Y],C)}f<E.length-1&&(!U||0<_&&!O)&&(R+=g)}}return R}function L(d,E){if(d==null)return"";if(d.constructor===Date)return JSON.stringify(d).slice(1,25);var U=!1;D&&typeof d=="string"&&D.test(d)&&(d="'"+d,U=!0);var R=d.toString().replace(y,K);return(U=U||c===!0||typeof c=="function"&&c(d,E)||Array.isArray(c)&&c[E]||function(F,M){for(var j=0;j<M.length;j++)if(-1<F.indexOf(M[j]))return!0;return!1}(R,i.BAD_DELIMITERS)||-1<R.indexOf(p)||R.charAt(0)===" "||R.charAt(R.length-1)===" ")?k+R+k:R}}};if(i.RECORD_SEP="",i.UNIT_SEP="",i.BYTE_ORDER_MARK="\uFEFF",i.BAD_DELIMITERS=["\r",`
`,'"',i.BYTE_ORDER_MARK],i.WORKERS_SUPPORTED=!t&&!!r.Worker,i.NODE_STREAM_INPUT=1,i.LocalChunkSize=10485760,i.RemoteChunkSize=5242880,i.DefaultDelimiter=",",i.Parser=_e,i.ParserHandle=Re,i.NetworkStreamer=H,i.FileStreamer=ie,i.StringStreamer=pe,i.ReadableStreamStreamer=fe,r.jQuery){var m=r.jQuery;m.fn.parse=function(s){var n=s.config||{},c=[];return this.each(function(g){if(!(m(this).prop("tagName").toUpperCase()==="INPUT"&&m(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var k=0;k<this.files.length;k++)c.push({file:this.files[k],inputElem:this,instanceConfig:m.extend({},n)})}),u(),this;function u(){if(c.length!==0){var g,k,K,I,h=c[0];if(b(s.before)){var D=s.before(h.file,h.inputElem);if(typeof D=="object"){if(D.action==="abort")return g="AbortError",k=h.file,K=h.inputElem,I=D.reason,void(b(s.error)&&s.error({name:g},k,K,I));if(D.action==="skip")return void p();typeof D.config=="object"&&(h.instanceConfig=m.extend(h.instanceConfig,D.config))}else if(D==="skip")return void p()}var y=h.instanceConfig.complete;h.instanceConfig.complete=function(V){b(y)&&y(V,h.file,h.inputElem),p()},i.parse(h.file,h.instanceConfig)}else b(s.complete)&&s.complete()}function p(){c.splice(0,1),u()}}}function w(s){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(n){var c=ve(n);c.chunkSize=parseInt(c.chunkSize),n.step||n.chunk||(c.chunkSize=null),this._handle=new Re(c),(this._handle.streamer=this)._config=c}.call(this,s),this.parseChunk=function(n,c){if(this.isFirstChunk&&b(this._config.beforeFirstChunk)){var u=this._config.beforeFirstChunk(n);u!==void 0&&(n=u)}this.isFirstChunk=!1,this._halted=!1;var p=this._partialLine+n;this._partialLine="";var g=this._handle.parse(p,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var k=g.meta.cursor;this._finished||(this._partialLine=p.substring(k-this._baseIndex),this._baseIndex=k),g&&g.data&&(this._rowCount+=g.data.length);var K=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(o)r.postMessage({results:g,workerId:i.WORKER_ID,finished:K});else if(b(this._config.chunk)&&!c){if(this._config.chunk(g,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);g=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(g.data),this._completeResults.errors=this._completeResults.errors.concat(g.errors),this._completeResults.meta=g.meta),this._completed||!K||!b(this._config.complete)||g&&g.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),K||g&&g.meta.paused||this._nextChunk(),g}this._halted=!0},this._sendError=function(n){b(this._config.error)?this._config.error(n):o&&this._config.error&&r.postMessage({workerId:i.WORKER_ID,error:n,finished:!1})}}function H(s){var n;(s=s||{}).chunkSize||(s.chunkSize=i.RemoteChunkSize),w.call(this,s),this._nextChunk=t?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(c){this._input=c,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(n=new XMLHttpRequest,this._config.withCredentials&&(n.withCredentials=this._config.withCredentials),t||(n.onload=Q(this._chunkLoaded,this),n.onerror=Q(this._chunkError,this)),n.open(this._config.downloadRequestBody?"POST":"GET",this._input,!t),this._config.downloadRequestHeaders){var c=this._config.downloadRequestHeaders;for(var u in c)n.setRequestHeader(u,c[u])}if(this._config.chunkSize){var p=this._start+this._config.chunkSize-1;n.setRequestHeader("Range","bytes="+this._start+"-"+p)}try{n.send(this._config.downloadRequestBody)}catch(g){this._chunkError(g.message)}t&&n.status===0&&this._chunkError()}},this._chunkLoaded=function(){n.readyState===4&&(n.status<200||400<=n.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:n.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(c){var u=c.getResponseHeader("Content-Range");return u===null?-1:parseInt(u.substring(u.lastIndexOf("/")+1))}(n),this.parseChunk(n.responseText)))},this._chunkError=function(c){var u=n.statusText||c;this._sendError(new Error(u))}}function ie(s){var n,c;(s=s||{}).chunkSize||(s.chunkSize=i.LocalChunkSize),w.call(this,s);var u=typeof FileReader<"u";this.stream=function(p){this._input=p,c=p.slice||p.webkitSlice||p.mozSlice,u?((n=new FileReader).onload=Q(this._chunkLoaded,this),n.onerror=Q(this._chunkError,this)):n=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var p=this._input;if(this._config.chunkSize){var g=Math.min(this._start+this._config.chunkSize,this._input.size);p=c.call(p,this._start,g)}var k=n.readAsText(p,this._config.encoding);u||this._chunkLoaded({target:{result:k}})},this._chunkLoaded=function(p){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(p.target.result)},this._chunkError=function(){this._sendError(n.error)}}function pe(s){var n;w.call(this,s=s||{}),this.stream=function(c){return n=c,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var c,u=this._config.chunkSize;return u?(c=n.substring(0,u),n=n.substring(u)):(c=n,n=""),this._finished=!n,this.parseChunk(c)}}}function fe(s){w.call(this,s=s||{});var n=[],c=!0,u=!1;this.pause=function(){w.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){w.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(p){this._input=p,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){u&&n.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),n.length?this.parseChunk(n.shift()):c=!0},this._streamData=Q(function(p){try{n.push(typeof p=="string"?p:p.toString(this._config.encoding)),c&&(c=!1,this._checkIsFinished(),this.parseChunk(n.shift()))}catch(g){this._streamError(g)}},this),this._streamError=Q(function(p){this._streamCleanUp(),this._sendError(p)},this),this._streamEnd=Q(function(){this._streamCleanUp(),u=!0,this._streamData("")},this),this._streamCleanUp=Q(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Re(s){var n,c,u,p=Math.pow(2,53),g=-p,k=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,K=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,I=this,h=0,D=0,y=!1,V=!1,L=[],d={data:[],errors:[],meta:{}};if(b(s.step)){var E=s.step;s.step=function(f){if(d=f,F())R();else{if(R(),d.data.length===0)return;h+=f.data.length,s.preview&&h>s.preview?c.abort():(d.data=d.data[0],E(d,I))}}}function U(f){return s.skipEmptyLines==="greedy"?f.join("").trim()==="":f.length===1&&f[0].length===0}function R(){return d&&u&&(j("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+i.DefaultDelimiter+"'"),u=!1),s.skipEmptyLines&&(d.data=d.data.filter(function(f){return!U(f)})),F()&&function(){if(!d)return;function f(S,O){b(s.transformHeader)&&(S=s.transformHeader(S,O)),L.push(S)}if(Array.isArray(d.data[0])){for(var _=0;F()&&_<d.data.length;_++)d.data[_].forEach(f);d.data.splice(0,1)}else d.data.forEach(f)}(),function(){if(!d||!s.header&&!s.dynamicTyping&&!s.transform)return d;function f(S,O){var T,N=s.header?{}:[];for(T=0;T<S.length;T++){var x=T,C=S[T];s.header&&(x=T>=L.length?"__parsed_extra":L[T]),s.transform&&(C=s.transform(C,x)),C=M(x,C),x==="__parsed_extra"?(N[x]=N[x]||[],N[x].push(C)):N[x]=C}return s.header&&(T>L.length?j("FieldMismatch","TooManyFields","Too many fields: expected "+L.length+" fields but parsed "+T,D+O):T<L.length&&j("FieldMismatch","TooFewFields","Too few fields: expected "+L.length+" fields but parsed "+T,D+O)),N}var _=1;return!d.data.length||Array.isArray(d.data[0])?(d.data=d.data.map(f),_=d.data.length):d.data=f(d.data,0),s.header&&d.meta&&(d.meta.fields=L),D+=_,d}()}function F(){return s.header&&L.length===0}function M(f,_){return S=f,s.dynamicTypingFunction&&s.dynamicTyping[S]===void 0&&(s.dynamicTyping[S]=s.dynamicTypingFunction(S)),(s.dynamicTyping[S]||s.dynamicTyping)===!0?_==="true"||_==="TRUE"||_!=="false"&&_!=="FALSE"&&(function(O){if(k.test(O)){var T=parseFloat(O);if(g<T&&T<p)return!0}return!1}(_)?parseFloat(_):K.test(_)?new Date(_):_===""?null:_):_;var S}function j(f,_,S,O){var T={type:f,code:_,message:S};O!==void 0&&(T.row=O),d.errors.push(T)}this.parse=function(f,_,S){var O=s.quoteChar||'"';if(s.newline||(s.newline=function(x,C){x=x.substring(0,1048576);var Y=new RegExp(he(C)+"([^]*?)"+he(C),"gm"),J=(x=x.replace(Y,"")).split("\r"),G=x.split(`
`),W=1<G.length&&G[0].length<J[0].length;if(J.length===1||W)return`
`;for(var B=0,A=0;A<J.length;A++)J[A][0]===`
`&&B++;return B>=J.length/2?`\r
`:"\r"}(f,O)),u=!1,s.delimiter)b(s.delimiter)&&(s.delimiter=s.delimiter(f),d.meta.delimiter=s.delimiter);else{var T=function(x,C,Y,J,G){var W,B,A,P;G=G||[",","	","|",";",i.RECORD_SEP,i.UNIT_SEP];for(var ne=0;ne<G.length;ne++){var v=G[ne],ce=0,X=0,oe=0;A=void 0;for(var Z=new _e({comments:J,delimiter:v,newline:C,preview:10}).parse(x),ee=0;ee<Z.data.length;ee++)if(Y&&U(Z.data[ee]))oe++;else{var te=Z.data[ee].length;X+=te,A!==void 0?0<te&&(ce+=Math.abs(te-A),A=te):A=te}0<Z.data.length&&(X/=Z.data.length-oe),(B===void 0||ce<=B)&&(P===void 0||P<X)&&1.99<X&&(B=ce,W=v,P=X)}return{successful:!!(s.delimiter=W),bestDelimiter:W}}(f,s.newline,s.skipEmptyLines,s.comments,s.delimitersToGuess);T.successful?s.delimiter=T.bestDelimiter:(u=!0,s.delimiter=i.DefaultDelimiter),d.meta.delimiter=s.delimiter}var N=ve(s);return s.preview&&s.header&&N.preview++,n=f,c=new _e(N),d=c.parse(n,_,S),R(),y?{meta:{paused:!0}}:d||{meta:{paused:!1}}},this.paused=function(){return y},this.pause=function(){y=!0,c.abort(),n=b(s.chunk)?"":n.substring(c.getCharIndex())},this.resume=function(){I.streamer._halted?(y=!1,I.streamer.parseChunk(n,!0)):setTimeout(I.resume,3)},this.aborted=function(){return V},this.abort=function(){V=!0,c.abort(),d.meta.aborted=!0,b(s.complete)&&s.complete(d),n=""}}function he(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function _e(s){var n,c=(s=s||{}).delimiter,u=s.newline,p=s.comments,g=s.step,k=s.preview,K=s.fastMode,I=n=s.quoteChar===void 0||s.quoteChar===null?'"':s.quoteChar;if(s.escapeChar!==void 0&&(I=s.escapeChar),(typeof c!="string"||-1<i.BAD_DELIMITERS.indexOf(c))&&(c=","),p===c)throw new Error("Comment character same as delimiter");p===!0?p="#":(typeof p!="string"||-1<i.BAD_DELIMITERS.indexOf(p))&&(p=!1),u!==`
`&&u!=="\r"&&u!==`\r
`&&(u=`
`);var h=0,D=!1;this.parse=function(y,V,L){if(typeof y!="string")throw new Error("Input must be a string");var d=y.length,E=c.length,U=u.length,R=p.length,F=b(g),M=[],j=[],f=[],_=h=0;if(!y)return z();if(s.header&&!V){var S=y.split(u)[0].split(c),O=[],T={},N=!1;for(var x in S){var C=S[x];b(s.transformHeader)&&(C=s.transformHeader(C,x));var Y=C,J=T[C]||0;for(0<J&&(N=!0,Y=C+"_"+J),T[C]=J+1;O.includes(Y);)Y=Y+"_"+J;O.push(Y)}if(N){var G=y.split(u);G[0]=O.join(c),y=G.join(u)}}if(K||K!==!1&&y.indexOf(n)===-1){for(var W=y.split(u),B=0;B<W.length;B++){if(f=W[B],h+=f.length,B!==W.length-1)h+=u.length;else if(L)return z();if(!p||f.substring(0,R)!==p){if(F){if(M=[],oe(f.split(c)),ye(),D)return z()}else oe(f.split(c));if(k&&k<=B)return M=M.slice(0,k),z(!0)}}return z()}for(var A=y.indexOf(c,h),P=y.indexOf(u,h),ne=new RegExp(he(I)+he(n),"g"),v=y.indexOf(n,h);;)if(y[h]!==n)if(p&&f.length===0&&y.substring(h,h+R)===p){if(P===-1)return z();h=P+U,P=y.indexOf(u,h),A=y.indexOf(c,h)}else if(A!==-1&&(A<P||P===-1))f.push(y.substring(h,A)),h=A+E,A=y.indexOf(c,h);else{if(P===-1)break;if(f.push(y.substring(h,P)),te(P+U),F&&(ye(),D))return z();if(k&&M.length>=k)return z(!0)}else for(v=h,h++;;){if((v=y.indexOf(n,v+1))===-1)return L||j.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:M.length,index:h}),ee();if(v===d-1)return ee(y.substring(h,v).replace(ne,n));if(n!==I||y[v+1]!==I){if(n===I||v===0||y[v-1]!==I){A!==-1&&A<v+1&&(A=y.indexOf(c,v+1)),P!==-1&&P<v+1&&(P=y.indexOf(u,v+1));var ce=Z(P===-1?A:Math.min(A,P));if(y.substr(v+1+ce,E)===c){f.push(y.substring(h,v).replace(ne,n)),y[h=v+1+ce+E]!==n&&(v=y.indexOf(n,h)),A=y.indexOf(c,h),P=y.indexOf(u,h);break}var X=Z(P);if(y.substring(v+1+X,v+1+X+U)===u){if(f.push(y.substring(h,v).replace(ne,n)),te(v+1+X+U),A=y.indexOf(c,h),v=y.indexOf(n,h),F&&(ye(),D))return z();if(k&&M.length>=k)return z(!0);break}j.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:M.length,index:h}),v++}}else v++}return ee();function oe(q){M.push(q),_=h}function Z(q){var Pe=0;if(q!==-1){var be=y.substring(v+1,q);be&&be.trim()===""&&(Pe=be.length)}return Pe}function ee(q){return L||(q===void 0&&(q=y.substring(h)),f.push(q),h=d,oe(f),F&&ye()),z()}function te(q){h=q,oe(f),f=[],P=y.indexOf(u,h)}function z(q){return{data:M,errors:j,meta:{delimiter:c,linebreak:u,aborted:D,truncated:!!q,cursor:_+(V||0)}}}function ye(){g(z()),M=[],j=[]}},this.abort=function(){D=!0},this.getCharIndex=function(){return h}}function it(s){var n=s.data,c=a[n.workerId],u=!1;if(n.error)c.userError(n.error,n.file);else if(n.results&&n.results.data){var p={abort:function(){u=!0,De(n.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:xe,resume:xe};if(b(c.userStep)){for(var g=0;g<n.results.data.length&&(c.userStep({data:n.results.data[g],errors:n.results.errors,meta:n.results.meta},p),!u);g++);delete n.results}else b(c.userChunk)&&(c.userChunk(n.results,p,n.file),delete n.results)}n.finished&&!u&&De(n.workerId,n.results)}function De(s,n){var c=a[s];b(c.userComplete)&&c.userComplete(n),c.terminate(),delete a[s]}function xe(){throw new Error("Not implemented.")}function ve(s){if(typeof s!="object"||s===null)return s;var n=Array.isArray(s)?[]:{};for(var c in s)n[c]=ve(s[c]);return n}function Q(s,n){return function(){s.apply(n,arguments)}}function b(s){return typeof s=="function"}return o&&(r.onmessage=function(s){var n=s.data;if(i.WORKER_ID===void 0&&n&&(i.WORKER_ID=n.workerId),typeof n.input=="string")r.postMessage({workerId:i.WORKER_ID,results:i.parse(n.input,n.config),finished:!0});else if(r.File&&n.input instanceof File||n.input instanceof Object){var c=i.parse(n.input,n.config);c&&r.postMessage({workerId:i.WORKER_ID,results:c,finished:!0})}}),(H.prototype=Object.create(w.prototype)).constructor=H,(ie.prototype=Object.create(w.prototype)).constructor=ie,(pe.prototype=Object.create(pe.prototype)).constructor=pe,(fe.prototype=Object.create(w.prototype)).constructor=fe,i})});function ft(e,r,t,o){return{scene:e,view:r,recordId:t,body:o}}function yt(e,r,t,o){return{scene:e,view:r,records:t}}function gt(e,r,t){return{scene:e,view:r,body:t}}function mt(e,r,t){return{scene:e,view:r,records:t}}function wt(e,r,t){return{scene:e,view:r,recordId:t}}function kt(e,r,t,o,a){if(o){var l=`https://api.knack.com/v1/pages/${e}/views/${r}/records?${o.name}_id=${o.id}`;return t&&(l+="&filters="+encodeURIComponent(JSON.stringify(t))),l}else{a||(a="both");let i={scene:e,view:r,format:a};return t&&(i.filters=t),i}}function _t(e,r,t){return{recordId:t.id,scene:e,view:r}}var $e={getSingle:(e,r,t)=>wt(e,r,t),getMany:(e,r,t,o,a)=>kt(e,r,t,o,a),postSingle:(e,r,t)=>gt(e,r,t),postMany:(e,r,t)=>mt(e,r,t),deleteSingle:(e,r,t)=>_t(e,r,t),putSingle:(e,r,t,o)=>ft(e,r,t,o),putMany:(e,r,t,o)=>yt(e,r,t,o)};function vt(e){return{match:e,rules:[]}}function bt(e){return{isDuringTheCurrentMonth:{field:e,operator:"is during the current",type:"month"},isDuringThePreviousMonth:{field:e,operator:"is during the previous",range:"1",type:"months"},isDuringTheNextMonth:{field:e,operator:"is during the next",range:"1",type:"months"},isBeforeThePreviousMonth:{field:e,operator:"is before the previous",range:"1",type:"months"}}}var je={create:e=>vt(e),common:e=>bt(e)};var It=Te(Ee(),1);var me=Te(Ee(),1);async function re(){let e="browser";if(e==="browser")return new me.default({auth:"view-based",applicationId:Knack.application_id,userToken:Knack.getUserToken()});if(e==="server"){let r=await At();return new me.default({auth:"view-based",applicationId:process.env.KNACK_APP_ID,userToken:r})}}async function At(){let e=new me.default({auth:"view-based",applicationId:process.env.KNACK_APP_ID});try{return await e.login({email:process.env.KNACK_API_LOGIN,password:process.env.KNACK_API_PASSWORD})}catch(r){console.log(r)}}async function Rt(e){let r=await re();console.log("api call started");try{let t=await r.get(e);return console.log("api call completed"),t.json}catch(t){return console.log("api call failed",t),null}}async function Dt(e){let r=await re();console.log("api call started");try{let t=await r.getMany(e);return console.log("api call completed"),t.records}catch(t){return console.log("api call failed",t),null}}async function xt(e){let r=e;var t=1,o=`&page=${t}&rows_per_page=1000`,a=r+o,l={Authorization:Knack.getUserToken(),"X-Knack-REST-API-Key":"knack","X-Knack-Application-Id":Knack.application_id,"Content-Type":"application/json"},i={},m=await He(a,l);if(i={...m},m.total_records>1e3){let H=m.total_pages;for(var w=2;w<=H;w++){var t=w,o=`&page=${t}&rows_per_page=1000`,a=r+o;m=await He(a,l),i.records=[...i.records,...m.records]}}return i}async function Pt(e){let r=await re();console.log("api call started");try{let t=await r.postMany(e);return t.summary.rejected>0&&t.summary.errors.forEach(o=>{console.log(JSON.stringify(o.reason))}),console.log("api call completed"),t}catch(t){return console.log("api call failed",t),null}}async function Ot(e){let r=await re();console.log("api call started");try{let o=(await r.post(e)).json;return console.log("api call completed"),o}catch(t){return console.log("api call failed",t),null}}async function Mt(e){let r=await re();console.log("api call started");try{let o=await(await r.put(e)).json;return console.log("api call completed"),o}catch(t){return console.log("api call failed",t),null}}async function $t(e){let r=await re();console.log("api call started");try{let t=await r.putMany(e);return t.summary.rejected>0&&res.summary.errors.forEach(o=>{errorHandler(o.reason)}),console.log("api call completed"),t}catch(t){return console.log("api call failed",t),null}}async function jt(e){let r=await re();console.log("api call started");try{let t=await r.delete(e);return console.log("api call completed"),t}catch(t){return console.log("api call failed",t),null}}async function He(e,r){console.log("api call started");try{let o=await(await fetch(e,{method:"GET",headers:r})).json();return console.log("api call completed"),o}catch(t){return console.log("api call failed"),console.log("err",t),t}}var Je={getSingle:e=>Rt(e),getMany:e=>Dt(e),getManyParentRecord:e=>xt(e),postSingle:e=>Ot(e),postMany:e=>Pt(e),putMany:e=>$t(e),putSingle:e=>Mt(e),deleteSingle:e=>jt(e)};var Be={isoTo_MMDDYYYY:e=>Kt(e),isoTo_DDMMYYYY:e=>Ft(e)};function Kt(e){return e=new Date(e),{date:e.toLocaleDateString("en-US"),hours:(e.getUTCHours()%12||12).toString().padStart(2,"0"),minutes:e.getUTCMinutes().toString().padStart(2,"0"),am_pm:e.getUTCHours()>=12?"PM":"AM"}}function Ft(e){return e=new Date(e),{date:e.toLocaleDateString("en-GB"),hours:(e.getUTCHours()%12||12).toString().padStart(2,"0"),minutes:e.getUTCMinutes().toString().padStart(2,"0"),am_pm:e.getUTCHours()>=12?"PM":"AM"}}var we={filters:je,payloads:$e,calls:Je,utils:Be};function Lt(e){$("#"+e+" .popup-message").remove()}function Ut(e,r,t){var o=$("#"+e),a=$("<div>").addClass("popup-message"),l=$("<div>").html(r).css({marginBottom:"20px",fontSize:"18px",color:"#fff"}),i=$("<div>").addClass("progress-bar-container"),m=$("<div>").attr("id","popup-progress-bar-"+e).addClass("popup-progress-bar"),w=$("<div>").attr("id","progress-text-"+e).addClass("progress-text").text("0%");i.append(m),i.append(w),a.append(l),t==="progress"&&(a.append(i),console.log("progress popup"));var H=$("<div>").addClass("spinner-container"),ie=$("<i>").addClass("fa fa-spinner fa-spin spinner").attr("id","popup-spinner-"+e);H.append(ie),t==="spinner"&&(a.append(H),console.log("spinner popup")),console.log(a.html()),o.css("position","relative").append(a)}function Nt(e,r){$("#popup-progress-bar-"+e).css("width",r+"%"),$("#progress-text-"+e).text(Math.round(r)+"%")}var ze={add:(e,r,t)=>Ut(e,r,t),remove:e=>Lt(e),update:(e,r)=>Nt(e,r)};var qe={popup:ze};function Ve(e){$("#"+e.key+" .kn-table thead tr").prepend('<th><input type="checkbox"></th>'),$("#"+e.key+" .kn-table tbody tr").each(function(){$(this).hasClass("kn-table-group")?$(this).prepend("<td></td>"):$(this).prepend('<td><input type="checkbox"></td>')})}function Ye(e,r){r=r||(()=>!0),$("#"+e.key+' .kn-table thead input[type="checkbox"]').change(function(){var t=$(this).prop("checked");$("#"+e.key+' .kn-table tbody tr:not(.kn-table-group) input[type="checkbox"]').each(function(){var o=r();$(this).prop("checked",t&&o)})})}function Ge(e){let r=[];return $("#"+e.key+' .kn-table tbody tr:not(.kn-table-group) input[type="checkbox"]').each(function(){var t=$(this).prop("checked");if(t){var o=$(this).closest("tr").attr("id");r.push({id:o})}}),r}function We(e,r){let t=Knack.views[e.key].getFilters(),o;t.match?(t.rules.push(r),o=JSON.parse(JSON.stringify(t))):t.length?(t.push(r),o={match:"and",rules:JSON.parse(JSON.stringify(t))}):o=[r],Knack.views[e.key].handleChangeFilters(JSON.stringify(o))}function Xe(e,r){Knack.views[e.key].handleChangeFilters(JSON.stringify(r))}function Qe(e){var r=JSON.stringify(Knack.views[e.key].getFilters());Knack.views[e.key].handleChangeFilters(r)}var Ze={addCheckboxes:e=>Ve(e),addHeadEventHandler:(e,r)=>Ye(e,r),getChechedRecords:e=>Ge(e),addFilters:(e,r)=>We(e,r),setFilters:(e,r)=>Xe(e,r),reRender:e=>Qe(e)};var ue={msg:qe,views:{tables:Ze}};var tt=Te(et(),1);function Ht(e,r){return tt.default.parse(e,{header:!0,skipEmptyLines:!0,dynamicTyping:r}).data}async function Jt(e){try{let r=await fetch(e);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return(await r.text()).trim()}catch(r){console.error("Error fetching the CSV file:",r)}}function Bt(e){return e.map(t=>{let o={};for(let[a,l]of Object.entries(t))try{let i=a.replace(/\r/g,"").trim(),m=l.replace(/\r/g,"").trim();o[i]=m}catch{o[a]=l}return o})}function zt(e){let r=JSON.parse(e);return`<pre>${JSON.stringify(r,null,2)}</pre>`}var rt={parseCSV:(e,r)=>Ht(e,r),fetchCSV:e=>Jt(e),cleanCSV:e=>Bt(e),jsonToHtml:e=>zt(e)};function qt(e){let r=new Date(e),t=String(r.getDate()).padStart(2,"0"),o=String(r.getMonth()+1).padStart(2,"0"),a=r.getFullYear(),l=r.getHours(),i=String(r.getMinutes()).padStart(2,"0"),m=l>=12?"PM":"AM";l=l%12||12;let w=`${t}/${o}/${a}`,H=`${String(l).padStart(2,"0")}:${i} ${m}`;return{date:w,time:H,string:w+" "+H}}function Vt(e){let r=new Date(e);return r.setDate(r.getDate()-1),r.setHours(23,59,0,0),r.toISOString()}var nt={convert:{isoDateToDDMMYYYYHHMMampm:e=>qt(e)},operations:{ISO:{getPreviousDay1159pm:e=>Vt(e)}}};var ot={files:rt,times:nt};async function Yt(e,r){try{let o=await(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).text();return console.log("Success:",o),o}catch(t){console.error("Error:",t)}}async function Gt(e){try{let r=await $.ajax({url:e,method:"GET"});console.log("Success:",r)}catch(r){console.error("Error:",r)}}var Ie={GET:e=>Gt(e),POST:(e,r)=>Yt(e,r)};$(document).on("knack-form-submit.view_44",async function(e,r,t){e.preventDefault();let o="http://localhost:3000/api/accounting/add-wise-transactions",a={test:"test"},l=await Ie.POST(o,a);console.log(l)});$(document).on("knack-form-submit.view_42",async function(e,r,t){let o="http://localhost:3000/api/accounting/add-westpac-transactions",a={test:"test"},l=await Ie.POST(o,a);console.log(l)});var st=-1;$(document).on("knack-view-render.view_45",async function(e,r,t){if(st+=1,st%2===0){ue.msg.popup.add(r.key,"loading in progress","spinner");let a=we.payloads.getMany("scene_26","view_45"),l=await we.calls.getMany(a);console.log("records",l);let i=Wt(l);console.log("dupRecords",i);let m=we.filters.create("OR");for(var o of i){let w={field:"field_177",operator:"is",value:o.field_177_raw};m.rules.push(w)}console.log("filters",m),ue.views.tables.setFilters(r,m),ue.msg.popup.remove(r.key)}ue.views.tables.addCheckboxes(r),ue.views.tables.addHeadEventHandler(r),$("#view_45_filters").remove()});function Wt(e){let r=e.reduce((o,a)=>{let l=a.field_177_raw;return o[l]=(o[l]||0)+1,o},{});return e.filter(o=>r[o.field_177_raw]>=2)}import{knackApi as de}from"https://damoosnz.github.io/bimsc-knack-api/dist/bundle.js";$(document).on("knack-view-render.view_55",async function(e,r,t){let o=de.payloads.getMany("scene_31","view_53"),a=await de.calls.getMany(o);console.log("tr_types",a);let l=de.payloads.getMany("scene_31","view_52"),i=await de.calls.getMany(l);console.log("unPro_trs",i);let m=Xt(i);if(console.log("new_tr_types",m),m.length>0){let w=de.payloads.postMany("scene_31","view_54",m),H=await de.calls.postMany(w)}});function Xt(e){return e.reduce((t,o)=>{let a=o.field_176_raw,l=o.field_229_raw[0]?.id;return t.some(i=>i.field_231+i.field_232===a+l)||t.push({field_231:a,field_232:o.field_229_raw[0]?.id}),t},[])}$(document).on("knack-view-render.view_45",function(e,r,t){at(r,"field_228")});$(document).on("knack-view-render.view_46",function(e,r,t){at(r,"field_158")});function at(e,r){$(`#${e.key} td[data-field-key=${r}]`).each(function(){let t=$(this).find("span").text(),o=ot.files.jsonToHtml(t);$(this).html(o)})}import{knackApi as ke}from"https://damoosnz.github.io/bimsc-knack-api/dist/bundle.js";$(document).on("knack-view-render.view_38",async function(e,r,t){let o=ke.payloads.getMany("scene_30","view_50"),a=await ke.calls.getMany(o);console.log("unPro_trs",a);let l=ke.payloads.getMany("scene_31","view_53"),i=await ke.calls.getMany(l);console.log("tr_types",i),a.length>0});
/*! Bundled license information:

papaparse/papaparse.min.js:
  (* @license
  Papa Parse
  v5.4.1
  https://github.com/mholt/PapaParse
  License: MIT
  *)
*/
